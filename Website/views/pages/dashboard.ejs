<!-- views/pages/dashboard.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <% include ../partials/head %>
</head>
<body class="hold-transition">
    <div>
        
        <% include ../partials/sidebar %>
        <div class = "content-container">
            <div class = "container-fluid">
                <div style="margin:20px">
                    <h1>Dashboard </h1>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="card-counter success">
                        <i class="fa fa-car"></i>
                        <span class="count-numbers" id="num-parking-spots">#</span>
                        <span class="count-name">open parking spots</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card-counter info">
                        <i class="fa fa-users"></i>
                        <span class="count-numbers" id="num-reservations">#</span>
                        <span class="count-name">reservations today</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <% include ../partials/footer %>
    </div>

</body>
</html>

<script>
    $(document).ready( function () {
        getParking();
        getNumReservations();
    });

    function getParking() {
        $.post("/getParkingSpots", {
        },
        function (data, status) {
            if (data.status == "Success") {
                $("#num-parking-spots").html(data.data[0].spots);
            } else {
                alert("Error getting parking spots");
            }
        });
    }

    function getNumReservations() {
        $.post("/getNumReservations", {
        }, 
        function (data, status) {
            if (data.status == "Success" ) {
                console.log(data.data[0].num);
                $("#num-reservations").html(data.data[0].num);
            } else {
                alert("Error getting today's number of reservations");
            }
        });
    }
</script>